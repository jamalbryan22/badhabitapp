  <!-- Success and Error Messages -->
  <div *ngIf="successMessage" class="alert alert-success">
    {{ successMessage }}
  </div>
  <div *ngIf="errorMessage" class="alert alert-danger">
    {{ errorMessage }}
  </div>

  <div class="container mt-4">
    <h2>Your Habits</h2>

    <div *ngIf="errorMessage" class="alert alert-danger">
      {{ errorMessage }}
    </div>

    <div *ngIf="successMessage" class="alert alert-success">
      {{ successMessage }}
    </div>

    <div *ngIf="userHabits.length > 0; else noHabits">
      <div class="row">
        <div *ngFor="let habit of userHabits" class="col-md-4 mb-3">
          <div class="card">
            <div class="card-body">
              <h3 class="card-title">{{ habit.additionType }}</h3>
              <p class="card-text"><strong>Description:</strong> {{ habit.habitDescription || 'No description provided.' }}</p>
              <p class="card-text"><strong>Your Motivation:</strong> {{ habit.userMotivation || 'No motivation provided.' }}</p>
              <hr>
              <h4>Insights</h4>
              <p class="card-text"><strong>Days Since Last Relapse:</strong> {{ daysSinceLastRelapse }}</p>
              <p class="card-text"><strong>Money Saved:</strong> {{ moneySaved | currency:'USD':'symbol':'1.2-2' }}</p>
              <hr>
              <p class="card-text"><strong>Habit Start Date:</strong> {{ habit.habitStartDate | date:'MM/dd/yyyy' }}</p>
              <p class="card-text"><strong>Goal:</strong> {{ habit.goalType }} - {{ habit.goalMetric }} {{ habit.goalValue }}</p>
              <hr />
              <h4>Relapse History</h4>
              <div *ngIf="habit; else noHabit">
                <div *ngIf="habit.relapses && habit.relapses.length > 0; else noRelapses">
                  <ul>
                    <li *ngFor="let relapse of habit.relapses">
                      {{ relapse.relapseDate | date:'MM/dd/yyyy' }} - {{ relapse.reason }}
                    </li>
                  </ul>
                </div>
              </div>
              <ng-template #noRelapses>
                <p>No recent relapses logged.</p>
              </ng-template>
              <ng-template #noHabit>
                <p>No habit data available.</p>
              </ng-template>

            </div>
          </div>
        </div>
      </div>
    </div>
    <ng-template #noHabits>
      <p>No habits associated with your account yet.</p>
    </ng-template>
  </div>

  <!-- Relapse Modal -->
  <div class="modal" tabindex="-1" [ngClass]="{'show': showRelapseModal}" [ngStyle]="{'display': showRelapseModal ? 'block' : 'none'}">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Log Relapse</h5>
          <button type="button" class="close" (click)="closeRelapseModal()">
            <span>&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="reasonForRelapse">Reason for Relapse</label>
            <textarea id="reasonForRelapse" class="form-control" [(ngModel)]="reasonForRelapse"></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" (click)="closeRelapseModal()">Cancel</button>
          <button type="button" class="btn btn-primary" (click)="logRelapse()">Confirm Relapse</button>
        </div>
      </div>
    </div>
  </div>
